<h2>Welcome, {{ student.name }}</h2>
<p>MAC: {{ student.mac_address }}</p>

<h3>Attendance History</h3>
<table >
    <tr>
        <th>Date & Time</th>
    </tr>
    {% for r in records %}
    <tr>
        <td>{{ r.timestamp }}</td>
    </tr>
    {% empty %}
    <tr><td>No attendance records found.</td></tr>
    {% endfor %}
</table>

<!-- Bar Graph -->
<h3>Attendance Overview (Last 10 Entries)</h3>
<canvas id="attendanceChart" width="600" height="300"></canvas>

<!-- Chart.js Script -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const labels = {{ attendance_data|safe }};
    const data = {
        labels: labels.reverse(),  // Oldest to latest
        datasets: [{
            label: 'Attendance',
            data: labels.map(() => 1),  // All bars = 1 (indicates presence)
            backgroundColor: 'rgba(75, 192, 192, 0.7)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1,
            barThickness: 30
        }]
    };

    const config = {
        type: 'bar',
        data: data,
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    max: 1,
                    ticks: {
                        stepSize: 1,
                        callback: function(value) {
                            return value === 1 ? 'Present' : '';
                        }
                    },
                    title: {
                        display: true,
                        text: 'Attendance'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Date & Time'
                    }
                }
            }
        }
    };

    new Chart(
        document.getElementById('attendanceChart'),
        config
    );
</script>

<!-- Logout Link -->
<a href="{% url 'logout' %}">Logout</a>
